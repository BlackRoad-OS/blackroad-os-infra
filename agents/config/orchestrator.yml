# =============================================================================
# BlackRoad OS Agent Orchestrator Configuration
# =============================================================================
# Defines the agent system architecture and coordination rules
# =============================================================================

version: "1.0"
name: "BlackRoad OS Agent Orchestrator"

# -----------------------------------------------------------------------------
# System Configuration
# -----------------------------------------------------------------------------
system:
  name: blackroad-os
  environment: production
  log_level: info
  heartbeat_interval: 30  # seconds
  max_concurrent_agents: 100
  agent_timeout: 300      # seconds

# -----------------------------------------------------------------------------
# Agent Registry
# -----------------------------------------------------------------------------
agents:
  # Core System Agents
  cece:
    type: orchestrator
    description: "Primary orchestrator - manages all BlackRoad OS operations"
    capabilities:
      - infrastructure_management
      - deployment_orchestration
      - health_monitoring
      - incident_response
    endpoints:
      - agents.blackroad.systems
    priority: critical

  beacon:
    type: identity
    description: "Identity and authentication agent"
    capabilities:
      - authentication
      - authorization
      - session_management
      - token_validation
    endpoints:
      - beacon.blackroad.systems
    priority: critical

  operator:
    type: worker
    description: "Background job processor"
    capabilities:
      - job_scheduling
      - task_execution
      - queue_management
      - retry_handling
    endpoints:
      - operator.blackroad.systems
    priority: high

  # Domain Agents
  research:
    type: specialist
    description: "Research and analysis agent"
    capabilities:
      - data_analysis
      - report_generation
      - trend_detection
      - knowledge_synthesis
    endpoints:
      - research.blackroad.systems
    priority: medium

  archive:
    type: storage
    description: "Archival and persistence agent"
    capabilities:
      - data_archival
      - version_control
      - backup_management
      - retrieval
    endpoints:
      - archive.blackroad.systems
    priority: medium

  # Pack Agents
  finance_agent:
    type: specialist
    description: "Financial analysis and reporting"
    capabilities:
      - financial_analysis
      - budget_tracking
      - invoice_processing
      - reporting
    endpoints:
      - finance.blackroad.systems
    priority: medium
    pack: finance

  legal_agent:
    type: specialist
    description: "Legal document processing"
    capabilities:
      - contract_analysis
      - compliance_checking
      - document_generation
      - risk_assessment
    endpoints:
      - legal.blackroad.systems
    priority: medium
    pack: legal

  devops_agent:
    type: specialist
    description: "DevOps automation"
    capabilities:
      - deployment_automation
      - infrastructure_provisioning
      - monitoring_setup
      - incident_management
    endpoints:
      - devops.blackroad.systems
    priority: high
    pack: infra-devops

  lab_agent:
    type: specialist
    description: "Research lab experiments"
    capabilities:
      - experiment_design
      - data_collection
      - result_analysis
      - hypothesis_testing
    endpoints:
      - lab.blackroad.systems
    priority: low
    pack: research-lab

  gaia:
    type: specialist
    description: "Truth verification and hash generation agent"
    capabilities:
      - hash_generation
      - truth_manifest_creation
      - component_verification
      - integrity_validation
    endpoints:
      - gaia.blackroad.systems
    priority: critical

# -----------------------------------------------------------------------------
# Communication Protocols
# -----------------------------------------------------------------------------
protocols:
  internal:
    type: grpc
    port: 50051
    tls: true
    retry_policy:
      max_retries: 3
      backoff: exponential

  external:
    type: rest
    port: 8080
    tls: true
    rate_limit:
      requests_per_minute: 1000
      burst: 100

  events:
    type: websocket
    port: 8081
    heartbeat: 30

# -----------------------------------------------------------------------------
# Task Routing
# -----------------------------------------------------------------------------
routing:
  # Route by capability
  capability_routes:
    authentication: beacon
    authorization: beacon
    deployment: [operator, devops_agent]
    analysis: [research, lab_agent]
    storage: archive
    financial: finance_agent
    legal: legal_agent
    hash_generation: gaia
    truth_manifest_creation: gaia
    component_verification: gaia
    integrity_validation: gaia

  # Load balancing
  load_balancing:
    strategy: round_robin
    health_check_interval: 10
    unhealthy_threshold: 3

  # Fallback chains
  fallbacks:
    operator: [devops_agent, cece]
    research: [lab_agent, cece]
    beacon: [cece]  # Critical - escalate to orchestrator

# -----------------------------------------------------------------------------
# Workflows
# -----------------------------------------------------------------------------
workflows:
  deploy_service:
    description: "Deploy a service to production"
    steps:
      - agent: devops_agent
        action: validate_deployment
      - agent: operator
        action: run_tests
      - agent: devops_agent
        action: deploy
      - agent: cece
        action: verify_health
      - agent: archive
        action: log_deployment

  incident_response:
    description: "Respond to system incidents"
    steps:
      - agent: cece
        action: assess_severity
      - agent: operator
        action: gather_diagnostics
      - agent: devops_agent
        action: implement_fix
      - agent: cece
        action: verify_resolution
      - agent: archive
        action: create_postmortem

  data_analysis:
    description: "Analyze data and generate reports"
    steps:
      - agent: research
        action: collect_data
      - agent: lab_agent
        action: run_analysis
      - agent: research
        action: generate_report
      - agent: archive
        action: store_results

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
security:
  authentication:
    method: jwt
    issuer: beacon.blackroad.systems
    audience: blackroad-os
    expiry: 3600

  authorization:
    model: rbac
    default_role: agent
    roles:
      orchestrator:
        permissions: ["*"]
      critical:
        permissions: ["read", "write", "execute", "admin"]
      high:
        permissions: ["read", "write", "execute"]
      medium:
        permissions: ["read", "write"]
      low:
        permissions: ["read"]

  encryption:
    in_transit: tls_1_3
    at_rest: aes_256_gcm

# -----------------------------------------------------------------------------
# Observability
# -----------------------------------------------------------------------------
observability:
  metrics:
    enabled: true
    endpoint: /metrics
    labels:
      - agent
      - action
      - status

  tracing:
    enabled: true
    sampler: always_on
    exporter: otlp

  logging:
    format: json
    level: info
    fields:
      - timestamp
      - agent
      - action
      - correlation_id
      - duration
